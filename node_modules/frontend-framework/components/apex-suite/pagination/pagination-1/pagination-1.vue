<template>
    <nav 
        v-if="toShow"
        :class="componentName"
        data-label="Pagination navigation"
    >
        <ul>
            <li
                :class="{ 'disabled' : isFirstPage }"
                :disabled="isFirstPage"
                @click="goPage(1)"
                data-label="Go to first page"
            >
                <icon-double-chevron-left />
            </li>


            <!-- show 2 before, unless near start -->
            <li 
                v-if="paginationProperties.current_page > 2"
                @click="goPage(paginationProperties.current_page - 2)"
            >
                {{ paginationProperties.current_page - 2 }}
            </li> 
            
            <!-- show 1 before, unless near start -->
            <li 
                v-if="paginationProperties.current_page > 1"
                @click="goPage(paginationProperties.current_page - 1)"
            >
                {{ paginationProperties.current_page - 1 }}
            </li>

            <!-- show current page -->
            <li class="active">
                {{ paginationProperties.current_page }}
            </li> 

            <!-- show 1 after, unless near end -->
            <li 
                v-if="paginationProperties.current_page < paginationProperties.last_page"
                @click="goPage(paginationProperties.current_page + 1)"
            >
                {{ paginationProperties.current_page + 1 }}
            </li> 

            <!-- show 2 after, unless near end -->
            <li 
                v-if="paginationProperties.current_page < paginationProperties.last_page - 1"
                @click="goPage(paginationProperties.current_page + 2)"
            >
                {{ paginationProperties.current_page + 2 }}
            </li>

            <!--  show all pages
            <li
                :class="{ 'active' : paginationProperties.current_page == key+1 }"
                v-for="(page, key) in paginationProperties.last_page"
                @click="goPage(key+1)"
            >
                {{ page }}            
            </li> 
            -->

            <li
                :class="{ 'disabled' : isLastPage }"
                :disabled="isLastPage"
                @click="goPage(paginationProperties.last_page)"
                data-label="Go to last page"
            >
                <icon-double-chevron-right />
            </li>
        </ul>
    </nav>
</template>




<script>    
    export default {
        name: "pagination1",
        props: {
            componentName: {
                default: "pagination-1",
                type: String
            },
            paginationProperties: {
                default: () => [{}],
                type: Object
            }
        },
        data() {
            return {
            }
        },
        computed: {
            isFirstPage() {
                if (this.paginationProperties.current_page === 1) {
                    return true;
                }
            },
            isLastPage() {
                if (this.paginationProperties.current_page === this.paginationProperties.last_page) {
                    return true;
                }
            },
            toShow() {
                if (this.paginationProperties.last_page > 1) {
                    return true;
                }
            }
        },
        methods: {
            goPage(requested) {
                if (requested !== this.paginationProperties.current_page) {
                    this.$emit('requested-page', requested);

                    //  also scroll to the top as (especially on mobile) lists can be long
                    window.scroll({
                        top: 0, 
                        behavior: 'smooth'
                    });
                }
            }
        }
    }
</script>