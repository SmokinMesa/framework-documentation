<template>
	<section :class="[componentName, { 'showing-modal' : isEnlarged }]"> 
		<div class="vehicle-tools">
			<div class="share-compare">
				<a class="favourite" href="#"><span hidden>Favourite this car</span></a>
				<a class="compare" href="#"><span hidden>Compare this car</span></a>
				<a class="share" href="#"><span hidden>Share this car</span></a>
			</div>

			<a href="#" class="enlarge" @click="toggleEnglarge()"><span hidden>Enlarge images</span></a>
		</div>

		<aside class="carousel-container">
			<img class="image-main" :src="vehicle.media_urls[currentImage].medium" :alt="vehicle.name">	
			
			<div class="thumbnail-container">
				<div class="prev" @click="scrollThumbs('prev')"><span hidden>Scroll carousel left</span></div>

				<ul ref="thumbs" class="thumbnails">
					<li v-for="(image, index) in vehicle.media_urls" :class="[{ 'active' : index === currentImage }, 'thumb-' + index]"><img class="image-thumbnail" :src="image.thumb" :alt="vehicle.name" @click="currentImage = index"></li>
				</ul>

				<div class="next" @click="scrollThumbs('next')"><span hidden>Scroll carousel right</span></div>
			</div>
		
			<ul class="nav">
				<li class="prev" @click="requestImage('prev')">
	                <span hidden>View previous image</span>
	            </li>

	            <li :class="{ 'disabled' : this.currentImage == (vehicle.media_urls.length -1) }" class="next" @click="requestImage('next')">
	                <span hidden>View next image</span>
	            </li>
        	</ul>
		</aside>
		
		<div class="content">
			<div class="vehicle-title">
				<h1><span class="reg-date">{{ vehicle.formatted_plate }}</span>{{ vehicle.model }}</h1>	
				<h2 class="vehicle-name">{{ vehicle.name | titlecase }}</h2>

				<div class="vehicle-branch">
					<p class="icon location">[Location]</p>

					<p class="icon phone">[00000 000000]</p>
				</div>
			</div>

			<div class="vehicle-price-container">
				<div class="vehicle-price">
					<p class="price">&pound;{{ vehicle.price | formatPrice }}</p>
					<p class="price-note">+ &pound;[fee] admin fee</p>
				</div>

				<div class="vehicle-price-monthly">
					<p v-if="hasFinance" class="price">[Â£pm]<span class="pcm">pcm</span></p>
					<p class="price-note">Hire Purchase</p>
				</div>
			</div>

			<section class="vehicle-summary">
				<ul class="summary-tabs">
					<li :class="{ 'active' : isVisible['overview'] }" @click="toggleIsVisible('overview')">Overview</li>
					<li :class="{ 'active' : isVisible['description'] }" @click="toggleIsVisible('description')">Description</li>
					<li :class="{ 'active' : isVisible['pricing'] }" @click="toggleIsVisible('pricing')">Pricing</li>
					<li :class="{ 'active' : isVisible['features'] }" @click="toggleIsVisible('features')">Features</li>
				</ul>

				<article v-if="isVisible['overview']" class="summary-content">
					<ul class="vehicle-specs">
						<li v-if="vehicle.odometer_value" class="spec-icon mileage">{{ vehicle.odometer_value | formatNumberWithCommas }} miles</li>
						<li v-if="vehicle.fuel_type.name" class="spec-icon fuel">{{ vehicle.fuel_type.name }}</li>
						<li v-if="vehicle.technical_spec.transmission" class="spec-icon transmission">{{ vehicle.technical_spec.transmission | titlecase }}</li>
						<li v-if="vehicle.odometer_value" class="spec-icon mileage">{{ vehicle.odometer_value | formatNumberWithCommas }} miles</li>
						<li v-if="vehicle.fuel_type.name" class="spec-icon fuel">{{ vehicle.fuel_type.name }}</li>
						<li v-if="vehicle.technical_spec.transmission" class="spec-icon transmission">{{ vehicle.technical_spec.transmission | titlecase }}</li>
						<li v-if="vehicle.odometer_value" class="spec-icon mileage">{{ vehicle.odometer_value | formatNumberWithCommas }} miles</li>
						<li v-if="vehicle.fuel_type.name" class="spec-icon fuel">{{ vehicle.fuel_type.name }}</li>
						<li v-if="vehicle.technical_spec.transmission" class="spec-icon transmission">{{ vehicle.technical_spec.transmission | titlecase }}</li>
						<li v-if="vehicle.odometer_value" class="spec-icon mileage">{{ vehicle.odometer_value | formatNumberWithCommas }} miles</li>
						<li v-if="vehicle.fuel_type.name" class="spec-icon fuel">{{ vehicle.fuel_type.name }}</li>
						<li v-if="vehicle.technical_spec.transmission" class="spec-icon transmission">{{ vehicle.technical_spec.transmission | titlecase }}</li>
						<li v-if="vehicle.odometer_value" class="spec-icon mileage">{{ vehicle.odometer_value | formatNumberWithCommas }} miles</li>
						<li v-if="vehicle.fuel_type.name" class="spec-icon fuel">{{ vehicle.fuel_type.name }}</li>
						<li v-if="vehicle.technical_spec.transmission" class="spec-icon transmission">{{ vehicle.technical_spec.transmission | titlecase }}</li>
					</ul>
				</article>

				<article v-if="isVisible['description']" class="summary-content">
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo.</p>
					<p>consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>				
				</article>

				<article v-if="isVisible['pricing']" class="summary-content">
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo.</p>
					<p>consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>	
				</article>

				<article v-if="isVisible['features']" class="summary-content">
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo.</p>
					<p>consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>	
				</article>
			</section>

			<div class="vehicle-cta">
				<a href="#" class="button outline" title="Apply for Finance">Apply for Finance</a>

				<a href="#" class="button primary outline" title="Enquire">Enquire</a>
			</div>
		</div>

		<transition name="enlarge" out-in>
			<div v-if="isEnlarged" class="enlarge-modal">
				<span class="close" @click="toggleEnglarge()"><span hidden>Close</span></span>

				<img :src="vehicle.media_urls[currentImage].large" :alt="vehicle.name">	
			</div>
		</transition>
	</section>
</template>




<script>
	export default {
		name: "VehicleHeader2",
		props: {
            componentName: {
                default: 'vehicle-header-2',
                type: String
            },
            vehicle: Object,
            hasFinance: {
                default: true,
                type: Boolean
            }      
		},
		data() {
			return {
				currentImage: 0,
				isEnlarged: false,
				isVisible: {
					'overview': true,
					'description': false,
					'pricing': false,
					'features': false
				}
			}
		},
		methods: {
			requestImage(requested) {
				if (requested === 'prev') {
					this.currentImage--;
					console.log('prev');
				}

				if (requested === 'next') {
					this.currentImage++;
					console.log('next');
				}
			},
			toggleEnglarge() {
				this.isEnlarged = !this.isEnlarged;
			},
			toggleIsVisible(requested) {
				//  this sets all false
				Object.keys(this.isVisible).forEach(v => this.isVisible[v] = false);

				this.isVisible[requested] = !this.isVisible[requested];
			},
			scrollThumbs(direction) {
				let scrollThis = this.$refs.thumbs;

				if (direction === 'prev') {
					scrollThis.scrollBy({
						top: 0,
						left: -200,
						behaviour: 'smooth'
					});
				} 
				
				if (direction === 'next') {

					scrollThis.scrollBy({
						top: 0,
						left: 200,
						behaviour: 'smooth'
					});
				}
			}
		}
	}
</script>