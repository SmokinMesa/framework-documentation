<template>
	<div :class="componentName" @mouseover="timerPause()" @mouseleave="timerPlay()">
		<div class="slide">
			<transition name="carousel-img" mode="in-out">
				<img class="main" :src="slides[currentSlide].imgUrl" :alt="slides[currentSlide].imgAlt" :key="currentSlide">
			</transition>

			<div class="content">
				<div class="sw">
					<transition name="carousel-content" mode="out-in">
						<section class="slide-content" v-html="slides[currentSlide].content" :key="currentSlide"></section>
					</transition>
						
					<transition name="carousel-content" mode="out-in">
						<keep-alive>
							<component :is="currentTabComponent" :key="currentSlide"></component>
						</keep-alive>
					</transition>
				</div>
			</div>
		</div>

        <ul class="nav">
            <li :class="{ 'disabled' : this.currentSlide == 0 }" class="prev" @click="scrollSlide('prev')">
            	<icon-chevron-left />
                <span hidden>View previous image</span>
            </li>

            <li v-for="(dot, index) of slides" class="slide-indicator" :class="{ 'active' : index == currentSlide }" @click="scrollSlide(index)">
            	<span hidden>View slide {{ index }}</span>
            </li>

            <li :class="{ 'disabled' : this.currentSlide == (this.slides.length -1) }" class="next" @click="scrollSlide('next')">
            	<icon-chevron-right />
                <span hidden>View next image</span>
            </li>
        </ul>
	</div>
</template>




<script>
	export default {
		name: 'HeroSliderBoth',	
		props: {
			componentName: {
				default: 'hero-slider-both',
				type: String
			},
			slides: {
				default: () => [
					{
						imgUrl: "https://images.unsplash.com/photo-1544675113-8459426ad558?ixlib=rb-1.2.1&auto=format&fit=crop&w=1442&q=80",
						imgAlt: "Image 1 alt text",
						content: '<h1>Search our collection of 84,588 cars</h1>',
						component: 'filter-mini-1'
					},
					{
						imgUrl: "https://images.unsplash.com/photo-1448518340475-e3c680e9b4be?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1351&q=80",
						imgAlt: "Image 2 alt text",
						content: '<h1>Banner Heading</h1><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit</p><button class="color-1">Learn more</button>',
						component: null
					},
					{
						imgUrl: "https://images.unsplash.com/photo-1467474750283-083e4610910c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&dpr=1&auto=format&fit=crop&w=1000&q=80&cs=tinysrgb",
						imgAlt: "Image 3 alt text",
						content: '<h1>Come and see our amazing cars</h1>',
						component: "statement-7"
					},
					{
						imgUrl: "https://images.unsplash.com/photo-1516069641779-5c2cebf40a15?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&dpr=1&auto=format&fit=crop&w=1000&q=80&cs=tinysrgb",
						imgAlt: "Image 4 alt text",
						content: '<h1>Join our mailing list</h1>',
						component: null
					}
				],
				type: Array
			},
			timeBetweenSlides: {
				default: 4000,
				type: Number
			},
			autoScroll: {
				default: false,
				type: Boolean
			}
		},
		data() {
			return {
				currentSlide: 0, 
				timerActivated: true,
				interval: null
			}
		},
		mounted() {
			if (this.autoScroll) {
				this.timerPlay();
			}
		},
		computed: {
			currentTabComponent() {
				return this.slides[this.currentSlide].component;
			}
		},
        methods: {
			timerPlay() {
				if (this.autoScroll) {
					this.timerActivated = true;

					var that = this;
					this.interval = setInterval(function () {
						that.tempTimer++;

						if (that.currentSlide < (that.slides.length - 1)) {
							that.currentSlide++;

							that.scrollSlide(that.currentSlide);
						}
						else if (that.currentSlide == (that.slides.length - 1)) {
							that.currentSlide = 0;
						}
					}, that.timeBetweenSlides);
				}
			},
			timerPause() {
				this.timerActivated = false;
				
				clearInterval(this.interval);
			},
            scrollSlide(dir) {
                if (dir == 'prev' && this.currentSlide > 0) {
                    this.currentSlide = this.currentSlide -= 1;
                } 
                else if (dir == 'next' && this.currentSlide < (this.slides.length - 1)) {
                    this.currentSlide = this.currentSlide += 1;
                } 
                else if (typeof dir === 'number') {
                	this.currentSlide = dir;
                }
            }
        }
	}
</script>