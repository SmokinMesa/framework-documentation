<template>
	<section :class="componentName">
		<div class="overflow-container" ref="carousel">
			<div class="overflow-inner">
				<slot><!-- slides passed in here --></slot>
			</div>
		</div>

	
		<nav v-if="numOfSlides > 1">
			<ul>
				<li 
					v-for="(position, index) in numOfSlides" 
					:class="{ 'active' : currentSlide === index }" 
					class="slide-indicator" 
					@click="setScrollPosition(index)"
				>
	            	<span hidden>View slide {{ index }}</span>
	            </li>
			</ul>
		</nav>
	</section>
</template>




<script>
	export default {
		name: 'CarouselTemplate',
		props: {
			componentName: {
				default: 'carousel-template',
				type: String
			},
		},
		data() {
			return {
				scrollPositions: [],
				numOfSlides: null,
				currentSlide: 0
			}
		},
		mounted() {
			// window.addEventListener('resize', this.createSlides);
			this.carousel = this.$refs.carousel;

			//  content not loaded in the DOM yet so give them a little time to load, to calculate width from
			var that = this;
			setTimeout(function () {
				that.createSlides();
			}, 1000);
		},
		methods: {
			createSlides() {
				let carouselWidth = this.carousel.offsetWidth;
				let carouselScrollWidth = this.carousel.scrollWidth;

				console.log('carouselWidth', carouselWidth);
				console.log('carouselScrollWidth', carouselScrollWidth);

				// // calculate no of slides needed
				// this.numOfSlides = Math.ceil(carouselScrollWidth / carouselWidth);

				// // set the first scroll position to 0
				// this.scrollPositions[0] = 0;

				// // set following scroll positions by incrementally adding carousel width
				// for (var i = 1; i < this.numOfSlides; i++) {
				// 	this.scrollPositions[i] = this.scrollPositions[i-1] + carouselWidth;
				// } 
			},
			setScrollPosition(index) {
				this.currentSlide = index;
				this.carousel.scrollLeft = this.scrollPositions[index];
			}
		},
		beforeDestroy() {
			window.removeEventListener('resize', this.createSlides);
		}
	}
</script>